import pyautogui
import random
import time
#rise of kingdoms farming bot 

def outsidecitybutton():
    try:
        outSideCityButton = pyautogui.locateCenterOnScreen('client_projects/rrs_bot_rok/assets/outSideCityButton.png', confidence=.5)
        if outSideCityButton is None:
            raise pyautogui.ImageNotFoundException
    except pyautogui.ImageNotFoundException:
        pyautogui.alert(
        text="Could not find the outside city button. Please make sure you are in the city and the button is visible on the screen.",
        title="RRS Bot"
        )
        exit()
    random1= random.randint(3, 15)
    outSideCityButton + (random1,random1)#change position a bit to avoid detection
    pyautogui.moveTo(outSideCityButton, duration=.3)
    pyautogui.click()
    
def searchglass():
    try:
        Searchglass = pyautogui.locateCenterOnScreen('client_projects/rrs_bot_rok/assets/Searchglass.png', confidence=.5)
        if Searchglass is None:
            raise pyautogui.ImageNotFoundException
    except pyautogui.ImageNotFoundException:
        pyautogui.alert(
        text="Could not find the Searchglass",
        title="RRS Bot"
        )
        exit()
    random1= random.randint(3, 15)
    Searchglass + (random1, random1) #change position a bit to avoid detection
    pyautogui.moveTo(Searchglass, duration=.3)
    pyautogui.click()
    
def foodsearch():
    try:
        print("looking for food search")
        foodSearch = pyautogui.locateCenterOnScreen('client_projects/rrs_bot_rok/assets/foodSearch.png', confidence=.8)
        if foodSearch is None:
            raise pyautogui.ImageNotFoundException
    except pyautogui.ImageNotFoundException:
        pyautogui.alert(
        text="Could not find the foodSearch",
        title="RRS Bot"
        )
        exit()
    pyautogui.moveTo(foodSearch, duration=.3)
    pyautogui.click()
    
def searchbutton():
    try:
        SearchButton = pyautogui.locateCenterOnScreen('client_projects/rrs_bot_rok/assets/SearchButton.png', confidence=.5)
        if SearchButton is None:
            raise pyautogui.ImageNotFoundException
    except pyautogui.ImageNotFoundException:
        pyautogui.alert(
        text="Could not find the SearchButton",
        title="RRS Bot"
        )
        exit()
    random1= random.randint(3, 15)
    searchbutton = SearchButton + (random1, random1)
    pyautogui.moveTo(searchbutton, duration=.3)
    print("clicking search button")
    pyautogui.click()
    
def gatherbutton():
    try:
        gatherbutton = pyautogui.locateCenterOnScreen('client_projects/rrs_bot_rok/assets/GatherButton.png', confidence=.5)
        if gatherbutton is None:
            raise pyautogui.ImageNotFoundException
    except pyautogui.ImageNotFoundException:
        pyautogui.alert(
        text="Could not find the gatherbutton",
        title="RRS Bot"
        )
        exit()
    random1= random.randint(3, 15)
    gatherbutton = gatherbutton + (random1, random1) #change position a bit to avoid detection
    pyautogui.moveTo(gatherbutton, duration=.3)
    pyautogui.click()

def newtroopbutton():
    try:
        newtroopbutton = pyautogui.locateCenterOnScreen('client_projects/rrs_bot_rok/assets/NewTroopButton.png', confidence=.5)
        if newtroopbutton is None:
            raise pyautogui.ImageNotFoundException
    except pyautogui.ImageNotFoundException:
        pyautogui.alert(
        text="Could not find the NewTroopButton",
        title="RRS Bot"
        )
        exit()
    random1= random.randint(3, 15)
    newtroopbutton = newtroopbutton + (random1, random1) #change position a bit to avoid detection
    pyautogui.moveTo(newtroopbutton, duration=.3)
    pyautogui.click()
    
def troop1():
    try:
        troop1 = pyautogui.locateCenterOnScreen('client_projects/rrs_bot_rok/assets/Troop1.png', confidence=.5)
        if troop1 is None:
            raise pyautogui.ImageNotFoundException
    except pyautogui.ImageNotFoundException:
        pyautogui.alert(
        text="Could not find the troop1",
        title="RRS Bot"
        )
        exit()
    troop1 + (random, random) #change position a bit to avoid detection
    pyautogui.moveTo(troop1, duration=.3)
    pyautogui.click()
    
def marchbutton():
    try:
        marchbutton = pyautogui.locateCenterOnScreen('client_projects/rrs_bot_rok/assets/MarchButton.png', confidence=.5)
        if marchbutton is None:
            raise pyautogui.ImageNotFoundException
    except pyautogui.ImageNotFoundException:
        pyautogui.alert(
        text="Could not find the marchbutton",
        title="RRS Bot"
        )
        exit()
    random1= random.randint(3, 15)
    marchbutton + (random1, random1) #change position a bit to avoid detection
    pyautogui.moveTo(marchbutton, duration=.3)
    pyautogui.click()
    
def woodsearch():
    try:
        print("looking for wood search")
        woodSearch = pyautogui.locateCenterOnScreen('client_projects/rrs_bot_rok/assets/woodSearch.png', confidence=.7)
        if woodSearch is None:
            raise pyautogui.ImageNotFoundException
    except pyautogui.ImageNotFoundException:
        pyautogui.alert(
        text="Could not find the woodSearch",
        title="RRS Bot"
        )
        exit()
    pyautogui.moveTo(woodSearch, duration=.3)
    pyautogui.click()    

def stonesearch():
    try:
        print("looking for stone search")
        stoneSearch = pyautogui.locateCenterOnScreen('client_projects/rrs_bot_rok/assets/stoneSearch.png', confidence=.6)
        if stoneSearch is None:
            raise pyautogui.ImageNotFoundException
    except pyautogui.ImageNotFoundException:
        pyautogui.alert(
        text="Could not find the stoneSearch",
        title="RRS Bot"
        )
        exit()
    pyautogui.moveTo(stoneSearch, duration=.3)
    pyautogui.click()    

def goldsearch():
    try:
        print("looking for gold search")
        goldSearch = pyautogui.locateCenterOnScreen('client_projects/rrs_bot_rok/assets/goldSearch.png', confidence=.7)
        if goldSearch is None:
            raise pyautogui.ImageNotFoundException
    except pyautogui.ImageNotFoundException:
        pyautogui.alert(
        text="Could not find the foodSearch",
        title="RRS Bot"
        )
        exit()
    pyautogui.moveTo(goldSearch, duration=.3)
    pyautogui.click()
     
def gathertype(type):
    if type == "food":
        foodsearch()
        time.sleep(.3)
        searchbutton()
        time.sleep(1.2)
        gatherbutton()
        time.sleep(.6)
        newtroopbutton()
        time.sleep(.6)
        marchbutton()
    elif type == "wood":
        woodsearch()
        time.sleep(.3)
        searchbutton()
        time.sleep(1.2)
        gatherbutton()
        time.sleep(.6)
        newtroopbutton()
        time.sleep(.6)
        marchbutton()
    elif type == "stone":
        stonesearch()
        time.sleep(.3)
        searchbutton()
        time.sleep(1.2)
        gatherbutton()
        time.sleep(.6)
        newtroopbutton()
        time.sleep(.6)
        marchbutton()
    elif type == "gold":
        goldsearch()
        time.sleep(.3)
        searchbutton()
        time.sleep(1.2)
        gatherbutton()
        time.sleep(.6)
        newtroopbutton()
        time.sleep(.6)
        marchbutton()
    else:
        pyautogui.alert(text="Something is very wrong",)
        
def AllArmiesBusy():
    try:
        AllArmiesBusy = pyautogui.locateCenterOnScreen('client_projects/rrs_bot_rok/assets/AllArmiesBusy1.png', confidence=.5)
        if AllArmiesBusy is None:
            raise pyautogui.ImageNotFoundException
    except pyautogui.ImageNotFoundException:
        return True
    return False 
    
pyautogui.prompt(text = "" , title = "RRS Bot", default = "Welcome to RRS Bot. Click OK to start the bot.")


outsidecitybutton()
notfull = True
while notfull == True:
    searchglass()
    randomrrsstype = random.choice(["food", "stone"])
    gathertype(randomrrsstype)
    notfull = AllArmiesBusy()
    
